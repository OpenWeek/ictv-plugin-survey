<html>
<head>
    <meta charset="utf-8">

    <title>OpenWeek 2017 - Développement de plugins pour ICTV v2</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/css/reveal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/css/theme/blood.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/lib/css/zenburn.css">

    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/' + (window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css');
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>

<body>
<div class="reveal">
    <div class="slides">
        <section id="titre">
            <h1>OpenWeek 2017</h1>
            <h2>Développement de plugins pour ICTV v2</h2>
            <a href="https://github.com/OpenWeek/ictv-plugins" target="_blank">https://github.com/OpenWeek/ictv-plugins</a>
            <br>
            <br>
            <small>Maxime Piraux - <a href="mailto:maxime.piraux@student.uclouvain.be" target="_blank">maxime.piraux@student.uclouvain.be</a></small>
        </section>
        <section id="intro">
            <h2>Qu'est ce que ICTV ?</h2>
            <ul>
                <li>ICTV est un <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_gestion_de_contenu" target="_blank">système de gestion de contenu</a> pour l'<a href="https://fr.wikipedia.org/wiki/Affichage_dynamique" target="_blank">affichage dynamique</a>.</li>
                <li>ICTV vous permet de créer et modifier du contenu qui sera affiché sur un réseau d'écrans.</li>
                <li>L'interface d'ICTV est entièrement basée sur le web. Tout depuis la gestion du contenu jusqu'à sa reproduction sur les écrans est effectué dans un navigateur.</li>
                <li>ICTV est facilement extensible grâce à un système de plugins simple et puissant.</li>
            </ul>
        </section>
        <section id="version">
            <h2>Pourquoi une version 2 ?</h2>
            <ul>
                <li>Affichage limité à des images statiques</li>
                <li>Pas de vidéos ou d'images animées</li>
                <li>Diaporama inerte, aucune transition dynamique possible</li>
                <li>Interface trop austère</li>
                <li>Opportunité de remise à plat de la conception du logiciel</li>
            </ul>
        </section>
        <section id="concepts">
            <h1>Trois concepts clés</h1>
            <ul>
                <li><a href="#/plugins">Plugins</a></li>
                <li><a href="#/channels">Channels</a></li>
                <li><a href="#/screens">Screens</a></li>
            </ul>
        </section>
        <section id="plugins">
            <h2>Plugins</h2>
            <p>Tout contenu provient d'un plugin.</p>
            <ul>
                <li>Un plugin peut être un programme automatisé.</li>
                <li>E.g. un programme qui crée du contenu à partir d'un flux RSS.</li>
                <li>Interaction plus large avec les utilisateurs possible à travers l'intégration d'une sous-application web propre au plugin dans ICTV.</li>
                <li>La configuration des plugins se fait via l'interface web d'ICTV.</li>
            </ul>
        </section>
        <section id="plugins-2">
            <h2>Plugins</h2>
            <p>Il existe déjà des plugins utiles:</p>
            <ul>
                <li><strong>editor</strong> est un éditeur web permettant de créer des diaporamas.</li>
                <li><strong>embed</strong> permet d'intégrer des pages web dans le système.</li>
                <li><strong>rss</strong> permet d'extraire et de transformer des flux RSS en diaporamas.</li>
                <li><strong>cal</strong> crée des annonces sur base d'événements de calendrier.</li>
                <li><strong>img-grabber</strong> extrait des images de pages web.</li>
            </ul>
        </section>
        <section id="channels">
            <h2>Channels</h2>
            <ul>
                <li>Elles permettent d'organiser le contenu.</li>
                <li>Chaque channel contient un type d'information thématique.</li>
                <li>Chaque channel est une instance, une paramétrisation, d'un plugin.</li>
                <li>Les channels peuvent être publiques ou restreintes à certains utilisateurs.</li>
            </ul>
        </section>
        <section id="screens">
            <h2>Screens</h2>
            <ul>
                <li>Une sortie affichant du contenu</li>
                <li>Peut être physique, i.e. un écran, ou virtuel, i.e. une page web.</li>
                <li>Les écrans diffusent le contenu des channels auxquelles ils sont abonnés.</li>
                <li>Les abonnements d'un écran vont déterminer le contenu qui y sera affiché.</li>
            </ul>
        </section>
        <section id="contenu">
            <h2>Contenu</h2>
            <ul>
                <li>Un diaporama de slides utilisant <a href="http://lab.hakim.se/reveal-js/" target="_blank">reveal.js</a></li>
                <li>Utilise les nombreuses possibilités offertes par HTML5 et CSS3.</li>
                <li>Compositions complexes, GIFs, vidéos et images de fond sont possibles.</li>
            </ul>
        </section>
        <section id="technologies">
            <h2>Technologies utilisées</h2>
            <ul>
                <li>
                    Coté client
                    <ul>
                        <li><a href="http://github.com/hakimel/reveal.js" target="_blank">reveal.js</a> pour les diaporamas.</li>
                        <li><a href="https://adminlte.io/preview" target="_blank">AdminLTE</a> pour l'interface utilisateur, basé sur JQuery et Bootstrap.</li>
                    </ul>
                </li>
                <li>
                    Coté serveur
                    <ul>
                        <li><a href="https://www.python.org/" target="_blank">Python 3.5+</a></li>
                        <li><a href="http://webpy.org/" target="_blank">web.py</a> comme framework web pour Python.</li>
                    </ul>
                </li>
            </ul>
        </section>
        <section id="intermede">
            <h1>Intermède</h1>
            <h3>Votre mission</h3>
            <p>Imaginer un nouveau plugin utile pour ICTV, pas nécessairement lié à l'INGI.</p>
            <p>Plus il peut être utilisé dans de nombreuses situations, plus son intérêt est grand.</p>
        </section>
        <section id="idees">
            <h2>Un peu d'inspiration</h2>
            <p>Actuellement, il n'y a pas d'interactions possibles pour le public regardant les écrans.</p>
            <p>Un plugin de sondage permettrait d'interroger les audiences et d'interagir avec ICTV.</p>
        </section>
        <section id="python-intro">
            <h1>Python</h1>
            <ul>
                <li>Démarré en 1990 par Guido Van Rossum</li>
                <li>Aujourd'hui à la version 3.6 (décembre 2016)</li>
                <li>Langage intreprété, multi-paradigme et multiplateformes</li>
                <li>Selon <a href="http://pypl.github.io/PYPL.html" target="_blank">PYPL</a><blockquote>Python grew the most in the last 5 years (8.7%)</blockquote></li>
            </ul>
            <img src="pypl.png">
        </section>
        <section id="python-intro-2">
            <h1>Python</h1>
            <ul>
                <li>Syntaxe élégante</li>
                <li>Conception axée vers la simplicité d'utilisation, sans compromettre la maintenabilité</li>
                <li>Interpréteur intégré pour tester facilement des bouts de code</li>
                <li>Gestion automatique de la mémoire</li>
                <li>Librairie standard très riche</li>
                <li>Intégration de modules en C/C++ possible</li>
            </ul>
        </section>
        <section id="python-paradigms">
            <h2>Paradigmes & typage</h2>
            <ul>
                <li>Paradigme procédural</li>
                <li>Paradigme orienté objet</li>
                <li>Paradigme fonctionnel</li>
                <li>Typage dynamique, comme JavaScript
                    <ul>
                        <li><code style="color: darkorange;">String string = "Hello, world!";</code></li>
                        <li><code style="color: green;">string = "Hello, world!"</code></li>
                    </ul>
                </li>
                <li>Typage fort, comme Java mais avec peu de conversions implicites
                    <ul>
                        <li><code style="color: darkorange;">String result = "Hello, world!" + 2;</code></li>
                        <li><code style="color: green;">result = "Hello, world!" + str(2)</code></li>
                    </ul>
                </li>
            </ul>
        </section>
        <section id="python-intermede">
            <h4 style="text-transform: inherit;">Une seule source d'information: la documentation officielle <a href="https://docs.python.org/3/" target="_blank">https://docs.python.org</a></h4>
            <iframe src="https://docs.python.org/3/tutorial/" class="stretch"></iframe>
            <strong><a href="https://docs.python.org/3/tutorial/" target="_blank">Le tutoriel officiel</a></strong>
        </section>
        <section id="python-types">
            <h2>Types</h2>
            <p>Toute valeur est un objet</p>
            <ul>
                <li>Pour les nombres: <code>int</code> et <code>float</code></li>
                <li>Pour les chaînes de caractères: <code>str</code>
                    <ul><li><code>''</code> et <code>""</code> pour les délimiter.</li></ul>
                </li>
                <li>Pour les booléens: <code>bool</code>
                    <ul><li><code>True</code> et <code>False</code></li></ul>
                </li>
                <li>Utilisé principalement pour des conversions explicites
                    <ul><li><code>str(2)</code> équivaut à <code>"2"</code> équivaut à <code>'2'</code></li></ul>
                </li>
                <li><code>None</code> est l'équivalent de <code>null</code> en Java.</li>
            </ul>
        </section>
        <section id="python-variables">
            <h2>Variables</h2>
            <ul>
                <li>Déclarées et initialisées en une instruction.</li>
                <li>Au moins une lettre, suivie de chiffres, lettres ou le caractère <code>_</code></li>
                <li>La convention de nomage est le <i>snake case</i>, e.g. <code>nom_de_variable</code></li>
                <li>Pas d'opérateur pour déclarer une variable, une première assignation dans le contexte courant compte comme une déclaration.</li>
                <li>Les variables commençant par <code>_</code> indiquent qu'elles sont privées.</li>
                <li>L'opérateur <code>del</code> permet de supprimer une variable du contexte.</li>
                <li>Pas de type explicitement associé à une variable</li>
            </ul>
        </section>
        <section id="python-strings">
            <h2>Strings</h2>
            <ul style="width: 80%;">
                <li><code>word = "Python"</code></li>
                <li>Répété avec <code>*</code>, concatené avec <code>+</code></li>
                <li>Peut être indexé:
                    <pre><code> +---+---+---+---+---+---+
 | P | y | t | h | o | n |
 +---+---+---+---+---+---+
 0   1   2   3   4   5   6
-6  -5  -4  -3  -2  -1
</code></pre>
                    <ul><li><code>word[2]</code> vaut <code>'t'</code></li></ul>
                </li>
                <li>Peut être <i>découpé (sliced)</i>:

                    <pre><code>>>> word[0:2]  # characters from position 0 (included) to 2 (excluded)
'Py'
>>> word[2:5]  # characters from position 2 (included) to 5 (excluded)
'tho'</code></pre>

                </li>
                <li>Les strings sont immutables.</li>
            </ul>
        </section>
        <section id="python-lists-tuples">
            <h2>Lists & tuples</h2>
            <ul>
                <li><code>squares = [1, 4, 9, 16, 25]</code></li>
                <li>Elle peut être indexée et découpée.</li>
                <li>Les listes sont mutables.</li>
                <li>Elles peuvent contenir des objet de type différents.</li>
                <li><code>coordinates = (4.2, 3.6)</code></li>
                <li>Indexable, découpable</li>
                <li>Immutable</li>
                <li>Unpacking: <code>x, y = coordinates</code></li>
            </ul>
        </section>
        <section id="python-sets-dicts">
            <h2>Sets & dictionary</h2>
            <pre><code>odd_numbers = {1, 3, 5, 7, 9}
capitals = {'Belgium': 'Brussels', 'France': 'Paris', 'Canada': 'Ottawa'}</code></pre>
            <ul>
                <li><code>2 in odd_numbers</code> équivaut à <code>False</code></li>
                <li><code>capitals['Canada']</code> équivaut à <code>'Ottawa'</code></li>
                <li><code>'France' in capitals</code> équivaut à <code>True</code></li>
                <li>Set et dict sont mutables.</li>
            </ul>
        </section>
        <section id="python-valeur-verite">
            <h2>Valeur de vérité</h2>
            <p>Sont considéré comme faux:</p>
            <ul>
                <li><code>None</code></li>
                <li>zéro pour tout type numérique</li>
                <li>Une list, tuple, set, string ou dict vide</li>
                <li>Tout objet dont la classe définit la méthode <code>__bool__</code> ou <code>__len__</code> si elle renvoie <code>0</code> ou <code>False</code></li>
            </ul>
            <p>Toute autre valeur est considérée comme vraie.</p>
        </section>
        <section id="python-operateurs-comparateurs">
            <h2>Opérateurs & comparateurs</h2>
            <ul>
                <li>Opérateurs booléens: <code>and</code>, <code>or</code> et <code>not</code></li>
                <li>Comparateurs: <code><</code>, <code><=</code>, <code>></code>, <code>>=</code>, <code>==</code>, <code>!=</code>, <code>is</code> et <code>is not</code></li>
            </ul>
        </section>
        <section id="python-syntaxe">
            <h2>Syntaxe</h2>
            <p>Python n'utilise pas d'accolades pour grouper des blocs d'instructions ensemble. L'indentation est sémantique.</p>
            <div style="display: flex;">
                <div style="flex: 1;">
                    <small>Java</small>
                    <pre><code data-trim>
                        if (x <= y)
                            x++;
                            y--;
                        z++;
                    </code></pre>
                </div>
                <div style="flex: 1;">
                    <small>Python</small>
                    <pre><code data-trim>
                        if x <= y:
                            x++
                            y--
                        z++
                    </code></pre>
                </div>
            </div>

            <p>Cela apporte moins d'erreurs et beaucoup plus de clarté.</p>
        </section>
        <section id="python-structure-de-controle">
            <h2>Structures de contrôle</h2>
            <div style="display: flex;">
                <div style="flex: 1;">
                    <pre><code data-trim>
                        if True:
                            pass
                        elif False:
                            pass
                        else:
                            pass
                    </code></pre>
                </div>
                <div style="flex: 1;">
                    <pre><code data-trim>
                        while i > 0:
                            pass
                    </code></pre>
                </div>
                <div style="flex: 1;">
                    <pre><code data-trim>
                        for i in range(10):
                            pass
                    </code></pre>
                </div>
            </div>
        </section>
        <section id="python-fonctions">
            <h2>Fonctions</h2>
            <pre><code data-trim>
                def fib(n, a=0, b=1):
                    """Print a Fibonacci series up to n."""
                    while a < n:
                        print(a, end=' ')
                        a, b = b, a+b
                    print()
                fib(10)  # equiv fib(n=10)
            </code></pre>
            <pre><code data-trim>
                def cheeseshop(kind, *arguments, **keywords):
                    print("-- Do you have any", kind, "?")
                    print("-- I'm sorry, we're all out of", kind)
                    for arg in arguments:
                        print(arg)
                    print("-" * 40)
                    for kw in keywords:
                        print(kw, ":", keywords[kw])
                </code>
                <code data-trim>
                >>> cheeseshop("Limburger", "It's very runny, sir.",
                ...            "It's really very, VERY runny, sir.",
                ...            shopkeeper="Michael Palin",
                ...            client="John Cleese",
                ...            sketch="Cheese Shop Sketch")
                </code><code data-trim>
                -- Do you have any Limburger ?
                -- I'm sorry, we're all out of Limburger
                It's very runny, sir.
                It's really very, VERY runny, sir.
                ----------------------------------------
                shopkeeper : Michael Palin
                client : John Cleese
                sketch : Cheese Shop Sketch
            </code></pre>
        </section>
        <section id="python-classes">
            <h2>Classes</h2>
            <pre><code data-trim>
                class Coordinate(object):
                    def __init__(self, x, y):
                        self.x = x
                        self.y = y
                    def dist_to_origin(self):
                        return sqrt(x ** 2 + y ** 2)

                point = Coordinate(1, 2)
                point.x = 4
                print(point.dist_to_origin())
            </code></pre>
        </section>
        <section id="python-modules-import">
            <h2>Modules et import</h2>
            <p>Un module est un fichier python importable depuis d'autres modules.</p>
            <div style="display: flex;">
                <pre style="flex: 1;"><code data-trim>
                    import math
                    math.sqrt(4)
                </code></pre>
                <pre style="flex: 1;"><code data-trim>
                    from math import sqrt
                    sqrt(4)
                </code></pre>
                <pre style="flex: 1;"><code data-trim>
                    from math import sqrt as sq
                    sq(4)
                </code></pre>
            </div>
            <p>Un fichier <code>__init__.py</code> permet a Python de considérer son dossier parent comme un module.</p>
            Lorsqu'un module est importé, tout son contexte global est exécuté.
            <pre><code>if __name__ == "__main__":
    # execute only if run as a script
    main()</code></pre>
        </section>
        <section id="python-gestion-exceptions">
            <h2>Gestion des exceptions</h2>
            <pre><code data-trim>
                try:
                    raise ValueError('Oops')
                except ValueError as e:
                    print('An exception flew by!')
                    raise
            </code></pre>
        </section>
        <section id="intro-plugin">
            <h1>Plugins dans ICTV</h1>
        </section>
        <!--
            systeme de templating
            montrer une template?
            montrer pluginSlide et Plugincapsule
         -->
        <section id="plugin-schema">
            <h2>Execution</h2>
            <img class="stretch" src="schema.svg" style="background: rgba(255, 255, 255, 0.66);">
        </section>
        <section id="plugin-slide-capsule">
            <h2>Slides & capsules</h2>
            <pre><code data-trim style="max-height: none;">
                class PluginSlide(metaclass=ABCMeta):
                    @abstractmethod
                    def get_duration(self):
                        pass

                    @abstractmethod
                    def get_content(self):
                        pass

                    @abstractmethod
                    def get_template(self):
                        pass

                class PluginCapsule(metaclass=ABCMeta):
                    @abstractmethod
                    def get_slides(self):
                        pass

                    @abstractmethod
                    def get_theme(self):
                        pass
            </code></pre>
        </section>
        <section id="plugin-contenu-slide">
            <h2>Contenu d'une slide</h2>
            <pre><code data-trim>
                {
                    '[field-type]-[field-number]': {'[input-type]': '[field-data]'},
                    ...
                }
            </code></pre>
            <div style="display: flex; height: 50%;" >
                <div style="flex: 1;">
                    <h5 style="text-transform: none">field-type</h5>
                    <code>
                    <ul>
                        <li>title</li>
                        <li>subtitle</li>
                        <li>text</li>
                        <li>logo</li>
                        <li>image</li>
                        <li>background</li>
                    </ul>
                    </code>
                </div>
                <div style="flex: 1;">
                    <h5 style="text-transform: none">input-type</h5>
                    <ul>
                        <li><code>title</code>, <code>subtitle</code>, <code>text</code>: <ul><li><code>text</code></li></ul></li>
                        <li><code>logo</code>, <code>image</code>:
                            <code><ul>
                                <li>src</li>
                                <li>qrcode</li>
                            </ul></code>
                        </li>
                        <li><code>background</code>:
                            <code><ul>
                                <li>src</li>
                                <li>size</li>
                                <li>qrcode</li>
                            </ul></code>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
        <section id="plugin-renderer">
            <h2>Renderer</h2>
            <p>Transforme la représentation abstraite d'une slide en HTML pour reveal.js via un template.</p>
            <div style="display: flex;">
                <pre style="flex: 2;"><code data-trim style="max-height: none;">
                    html
                    $def with (slide, theme)
                    <section>
                        <div class="logo logo-ucl">
                            $:logo(content=slide, number=1)
                        </div>
                        <div class="logo logo-fac">
                            $:logo(content=slide, number=2)
                        </div>
                        <div class="content">
                            $:title(content=slide, number=1)
                            $:subtitle(content=slide, number=1)
                            <table>
                                <tr>
                                    <td style="width:34%">
                                        $:img(content=slide, number=1)
                                    </td>
                                    <td style="width:66%; vertical-align:middle">
                                        $:text(content=slide, number=1)
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </section>
                </code></pre>
                <pre style="flex: 1;"><code data-trim style="max-height: none;">
                    {
                        'title-1': {'text': "Awesome title"},
                        'subtitle-1': {'text': "Subtile subtitle"},
                        'text-1': {'text': "Very long textual text here"},
                        'image-1': {'src': "img/michelfra.gif"},
                        'logo-1': {'src': "ingi.gif"},
                        'logo-2': {'src': "ucl.gif"}
                    }
                </code></pre>
            </div>
        </section>
        <section id="plugin-anatomie">
            <h2>Anatomie</h2>
            <pre><code data-trim>
                ictv
                └── plugins
                    └── img-grabber
                        ├── __init__.py
                        ├── config.yaml
                        └── img-grabber.py
            </code></pre>
            <ul>
                <li><code>config.yaml</code> définit la configuration nécessaire a une instance du plugin.</li>
                <li><code>img-grabber.py</code> contient une fonction <code>get_content()</code>.</li>
                <li><code>__init__.py</code> permet a Python de considérer ce dossier comme un module.</li>
            </ul>
        </section>
        <section id="plugin-config">
            <h2>Fichier de configuration</h2>
            <div style="display: flex;">
            <pre style="flex: 1;"><code data-trim style="max-height: none;">
                plugin:
                  webapp: no
                  static: no
                  description: |
                    This plugin embeds an image and a text
                    as legend in a simple way.
                    It uses CSS selector to specify which content
                    to grab from the specified page.
                  dependencies:
                    - pyquery
                channels_params:
                  url:
                    name: 'URL of the page'
                    placeholder: 'Url format'
                    type: string
                    default: 'http://apod.nasa.gov/apod/astropix.html'
                  image_selector:
                    name: 'Image CSS selector'
                    placeholder: 'CSS selector'
                    type: string
                    default: 'img'
                  src_attr:
                    name: 'Attribute holding the image source url'
                    placeholder: 'HTML attribute'
                    type: string
                    default: 'src'
            </code></pre>
            <pre style="flex: 1;"><code style="max-height: none;">
  text_selector:
  name: 'Text CSS selector'
  placeholder: 'CSS selector'
  type: string
  default: 'center>b'
  alternative_text:
  name: 'Alternative text if a text cannot be found with the selector above'
  placeholder: 'Plain text'
  type: string
  default: ''
  duration:
  name: 'Capsule duration in seconds'
  placeholder: 'Capsule duration in seconds'
  type: int
  default: 10
  min: 1
  qrcode:
  name: 'Embed the url of the page as a QR code'
  type: bool
  default: no
            </code></pre>
            </div>
        </section>
        <section id="plugin-slide">
            <h2>Slide</h2>
            <pre><code data-trim style="max-height: none;">
                class ImgGrabberSlide(PluginSlide):
                    def __init__(self, img_src, text, duration, qrcode):
                        self._duration = duration
                        self._content = {'background-1': {'src': img_src, 'size': 'contain'},
                                         'text-1': {'text': text}}
                        if qrcode:
                            self._content['image-1'] = {'qrcode': qrcode}
                        self._has_qr_code = qrcode is not None

                    def get_duration(self):
                        return self._duration

                    def get_content(self):
                        return self._content

                    def get_template(self):
                        return 'template-background-text-qr'
            </code></pre>
        </section>
        <section id="plugin-capsule">
            <h2>Capsule</h2>
            <pre><code data-trim style="max-height: none;">
                class ImgGrabberCapsule(PluginCapsule):
                    def __init__(self, img_src, text, duration, qrcode=None):
                        self._slides = [ImgGrabberSlide(img_src, text, duration, qrcode)]

                    def get_slides(self):
                        return self._slides

                    def get_theme(self):
                        return None
            </code></pre>
        </section>
        <section id="plugin-get-content">
            <h2>get_content</h2>
            <pre style="width: 95%;"><code data-trim style="max-height: none;">
                def get_content(channel_id):
                    channel = Channel.get(channel_id)

                    logger_extra = {'channel_name': channel.name, 'channel_id': channel.id}
                    logger = get_logger('img-grabber', channel)

                    url = channel.get_config_param('url')
                    image_selector = channel.get_config_param('image_selector')
                    attr = channel.get_config_param('src_attr')
                    qrcode = channel.get_config_param('qrcode')

                    if not url or not image_selector or not attr:
                        logger.warning('Some of the required parameters are empty', extra=logger_extra)
                        return []

                    try:
                        doc = PyQuery(url=url)
                    except Exception as e:
                        raise MisconfiguredParameters('url', url, 'The following error was encountered: %s.' % str(e))

                    img = doc(image_selector).eq(0).attr(attr)
                    if not img:
                        message = 'Could not find img with CSS selector %s and attribute %s' % (image_selector, attr)
                        raise MisconfiguredParameters('image_selector', image_selector, message)
                                  .add_faulty_parameter('src_attr', attr, message)
                    if img[:4] != 'http' and img[:4] != 'ftp:':
                        img = '{uri.scheme}://{uri.netloc}/'.format(uri=urlparse(url)) + img

                    duration = channel.get_config_param('duration') * 1000
                    text = doc(channel.get_config_param('text_selector')).eq(0).text()
                    alternative_text = channel.get_config_param('alternative_text')
                    return [ImgGrabberCapsule(img, text if text else alternative_text, duration,
                                              qrcode=url if qrcode else None)]
            </code></pre>
        </section>
        <section id="the-end">
            <h1>Et voila</h1>
            <h3>Pef</h3>
        </section>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/lib/js/head.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/js/reveal.js"></script>

<script>
    var cdn = 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.5.0/';
    Reveal.initialize({
        width: 1440,
        height: 1080,
        controls: true,
        progress: true,
        history: true,
        center: true,
        slideNumber: true,
        transition: 'slide',
        dependencies: [
            {
                src: cdn + 'plugin/highlight/highlight.js', async: true, callback: function () {
                    hljs.configure({
                        languages: ['python', 'html', 'yaml']
                    });
                    hljs.initHighlightingOnLoad();
                }
            }
        ]
    });
</script>

</body>
</html>
